version: 0.2


phases:
  pre_build:
    commands:
      - npm install
      - npm install -g @angular/cli
      - npm install serverless --global
      - npm install -g serverless-fix-apigw-int
      - export SERVERLESS_ACCESS_KEY=AKODcaD3pubdZywX3b47D13OfjWLdIct59VgJYizD5mHE
      - export AWS_ACCESS_KEY_ID=AKIAREHYAFIWKK2UH5HH,I571
      - export AWS_SECRET_ACCESS_KEY=KnBHSFD+Q+ZWE2iaYtJJLKKxEiJMg/7S9eJ
    
  build:
    commands:
      - ng build --prod
  post_build:
    commands:
      - serverless deploy --key AKIAREHYAFIWKK2UH5HH,I571 --secret KnBHSFD+Q+ZWE2iaYtJJLKKxEiJMg/7S9eJ
      - printf '{"ImageURI":"image_URI"}' > imageDetail.json
      - aws s3api list-buckets --query "Buckets[].Name"
      - aws s3 sync ./dist/MVP-FRONTEND s3://mvp-source-dev --acl 'public-read' --delete

artifacts:
  files:
    - imageDetail.json



      
